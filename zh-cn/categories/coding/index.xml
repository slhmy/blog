<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>ç¼–ç¨‹ on slhmy çš„åšå®¢</title><link>https://slhmy.github.io/blog/zh-cn/categories/coding/</link><description>Recent content in ç¼–ç¨‹ on slhmy çš„åšå®¢</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Sun, 02 Jul 2023 16:33:00 +0800</lastBuildDate><atom:link href="https://slhmy.github.io/blog/zh-cn/categories/coding/index.xml" rel="self" type="application/rss+xml"/><item><title>å¿«é€Ÿå­¦ä¹  Rust ç¼–ç¨‹è¯­è¨€</title><link>https://slhmy.github.io/blog/zh-cn/p/learn-rust-with-a-glance/</link><pubDate>Sun, 02 Jul 2023 16:33:00 +0800</pubDate><guid>https://slhmy.github.io/blog/zh-cn/p/learn-rust-with-a-glance/</guid><description>&lt;h2 id="å‰è¨€">å‰è¨€
&lt;/h2>&lt;p>å†™è¿™ç¯‡ Post çš„èµ·å› æ˜¯æˆ‘å¸Œæœ›æœ‰æ›´å¤šçš„äººèƒ½å‚ä¸åˆ°æˆ‘çš„å¼€æºé¡¹ç›®ä¸­æ¥ï¼Œ
ä½†å®ƒæ˜¯ç”¨ Rust å†™çš„ï¼Œè¿™è®©ä¸å°‘æƒ³è¦äº†è§£è¿™é¡¹ç›®çš„äººæ— æ³•å¿«é€ŸåŠ å…¥åˆ°å…¶ä¸­æ¥ã€‚
å½“ç„¶æˆ‘ä¹Ÿå¸Œæœ›èƒ½é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œèƒ½å¤Ÿè®©æ›´å¤šçš„äººä¸å†ç•æƒ§å¯¹æ–°è¯­è¨€çš„å­¦ä¹ ã€‚&lt;/p>
&lt;p>è€å®è¯´åœ¨åŠå¹´ä¹‹å‰ï¼Œæˆ‘ä¹Ÿä¼šç»å¸¸ç•æƒ§æˆ‘æ²¡æœ‰æ¥è§¦è¿‡çš„é«˜çº§ç¼–ç¨‹è¯­è¨€
ï¼ˆä¾‹å¦‚ï¼šæˆ‘ä¹Ÿæ›¾å› ä¸ºæ²¡æ¥è§¦è¿‡Goè€Œæ„Ÿåˆ°å›°æ‰°ï¼‰ã€‚
è€Œç°åœ¨ï¼Œæˆ‘å·²ç»èƒ½å¤Ÿå¿«é€Ÿé€‚åº”å¤šç§ä¸åŒé«˜çº§ç¼–ç¨‹è¯­è¨€çš„ä½¿ç”¨
ï¼ˆè¯·æ³¨æ„æˆ‘è¯´çš„æ˜¯é«˜çº§ç¼–ç¨‹è¯­è¨€ï¼‰ã€‚
åˆ°ç›®å‰ä¸ºæ­¢ï¼Œ
æˆ‘ä¼šåœ¨ä¸åŒæƒ…æ™¯ä¸‹ä½¿ç”¨ Goã€Rustã€JS/TSã€C#ã€Pythonã€C/C++ã€Java è¿™äº›é«˜çº§ç¼–ç¨‹è¯­è¨€ã€‚
ä¹‹æ‰€ä»¥èƒ½å¤Ÿå¿«é€Ÿæ¥è§¦åˆ°è¿™ä¹ˆå¤šè¯­è¨€ï¼Œæˆ‘è®¤ä¸ºæœ‰ä¸€äº›ç»éªŒæ˜¯éœ€è¦æŒ‡å‡ºçš„ï¼Œ
æ— è®ºæ˜¯åœ¨å­¦ä¹  Rust è¿˜æ˜¯ä»»ä½•ä¸€é—¨å…¶ä»–çš„é«˜çº§ç¼–ç¨‹è¯­è¨€ã€‚&lt;/p>
&lt;h3 id="å¦‚ä½•å¿«é€Ÿå…¥é—¨ä¸€ä¸ªæ–°çš„é«˜çº§ç¼–ç¨‹è¯­è¨€">å¦‚ä½•å¿«é€Ÿå…¥é—¨ä¸€ä¸ªæ–°çš„é«˜çº§ç¼–ç¨‹è¯­è¨€
&lt;/h3>&lt;p>é¦–å…ˆï¼Œå¦‚æœä½ æœ‰è¿‡å‡ å¹´çš„ç¼–ç¨‹ç»éªŒï¼Œ&lt;u>æˆ‘ä¸æå€¡ä¸ºäº†å­¦ä¸€é—¨è¯­è¨€è€Œå»åšä¸“é¡¹çš„å­¦ä¹ &lt;/u>ã€‚
å› ä¸ºåœ¨æ²¡æœ‰é¡¹ç›®å‚è€ƒçš„æƒ…å†µä¸‹ï¼Œå­¦ä¹ ç¼–ç¨‹è¯­è¨€çš„æˆæœ¬æ˜¯æ¯”è¾ƒé«˜çš„ï¼Œ
è¿™ä¼šä¸æ˜æ‰€ä»¥åœ°æ¶ˆè€—ä½ å¤§é‡çš„æ—¶é—´ã€‚&lt;/p>
&lt;p>ä½ éœ€è¦å˜å¾—è‡ªä¿¡ï¼š&lt;u>é«˜çº§ç¼–ç¨‹è¯­è¨€æœ¬èº«å°±æ˜¯äººç±»å¯è¯»çš„æ–‡æœ¬ï¼ŒåŸºæœ¬æ²¡æœ‰ç†ç”±çœ‹ä¸æ‡‚&lt;/u>ã€‚
ä¼šé€ æˆå›°æ‰°çš„æ˜¯å®ƒä»¬å½“ä¸­&lt;strong>ä¸åŒçš„è¯­ä¹‰ç¬¦å·å’Œä¸€äº›è¾ƒä¸ºç‰¹æ®Šçš„è¯­è¨€æœºåˆ¶&lt;/strong>ï¼Œ
é€šå¸¸æ¥è¯´è¿™äº›ä¸åŒä¼šè®©ä½ åœ¨ç©ºæ‰‹è¿›è¡Œå¼€å‘æ—¶ç»™ä½ é€ æˆæ¯”è¾ƒå¤§çš„å›°æ‰°ï¼Œ
ä½†å¦‚æœä»…æ˜¯è¿›è¡Œé˜…è¯»ï¼Œç†è§£ä»£ç çš„é€»è¾‘å«ä¹‰è¿˜æ˜¯è¾ƒä¸ºè½»æ¾çš„ã€‚&lt;/p>
&lt;p>&lt;u>ä¸°å¯Œçš„ RealWorld é¡¹ç›®ç»å†ä¼šé™ä½å­¦ä¹ çš„æˆæœ¬&lt;/u>ã€‚
ä»£ç å’Œè¯»ä¹¦è™½ç„¶å¾ˆæ¥è¿‘ï¼Œä½†ä¹Ÿè¿˜æ˜¯ç•¥æœ‰ä¸åŒï¼Œ
å› ä¸ºå†™çš„ä»£ç å±‚æ¬¡ä¸€æ—¦å¼€å§‹å˜å¾—å¤æ‚ï¼Œä½ å°±éœ€è¦ä½¿ç”¨ä¸€äº›å¸¸è§çš„æ–¹æ³•å»å¸®å¿™é™ä½æ„æ€çš„å¤æ‚åº¦ï¼Œ
ä¾‹å¦‚ï¼šé¢å‘å¯¹è±¡ã€è®¾è®¡æ¨¡å¼ã€å‡½æ•°å¼ç¼–ç¨‹ç­‰ç­‰ã€‚
ä½ ä¸ä¸€å®šä¼šåœ¨æ‰€æœ‰è¯­è¨€ä¸­ä½¿ç”¨åˆ°å®ƒä»¬ï¼Œä½†å®æˆ˜ç»å†ä¼šè®©ä½ æ›´æ–¹ä¾¿ç†è§£å’Œå†™å‡ºæ›´å¥½çš„ä»£ç ã€‚
é™¤æ­¤ä»¥å¤–ï¼Œé¡¹ç›®ä¸­æ—¶å¸¸ä¼šç”¨åˆ°æ‰©å±•ä¾èµ–ï¼Œæ¯”å¦‚è¯´åºåˆ—åŒ–å·¥å…·ã€æ•°æ®åº“é©±åŠ¨ã€Web æ¡†æ¶ç­‰ï¼Œ
æ¯ä¸ªè¯­è¨€éƒ½æœ‰ï¼Œå¹¶ä¸”ç”¨é€”å’ŒåŠŸèƒ½éƒ½æ˜¯å¯ä»¥æ€»ç»“çš„ã€‚&lt;/p>
&lt;p>æœ€åï¼Œ2023å¹´äº†&lt;u>æä¸€ä¸ª AI è”æƒ³å¸®ä¸‹å¿™å§&lt;/u>ã€‚
åœ¨ç¼–å†™è‡ªå·±ä¸ç†Ÿæ‚‰çš„è¯­è¨€æ—¶ï¼Œé™Œç”Ÿçš„å£°æ˜å¼å’Œç¬¦å·ä¼šè®©äººæ„Ÿåˆ°æ‡Šæ¼ã€‚
AIèƒ½å¸®åŠ©ä½ å°½å¯èƒ½è§„é¿ç±»ä¼¼çš„é—®é¢˜ï¼Œå¤šä¸€ä»½è”ç³»ä¹Ÿæ˜¯å¤šäº†ä¸€ä»½å‚è€ƒã€‚&lt;/p>
&lt;h2 id="rust-å¿«é€Ÿå…¥é—¨">Rust å¿«é€Ÿå…¥é—¨
&lt;/h2>&lt;p>è¿›å…¥æ­£é¢˜ï¼Œå…¶å®ä¸Šé¢è¯´äº†é‚£ä¹ˆå¤šï¼Œä¹Ÿæ˜¯ä¸ºäº†åœ¨è¿™ä¸ªç¯èŠ‚å°½é‡å°‘è¯´ä¸€äº›ã€‚
æ¥å—ä¸‹åˆ’çº¿æ ‡æ³¨å‡ºçš„å…³é”®ç‚¹ï¼Œæˆ‘è®¤ä¸ºé€šå¸¸æ¥è¯´å·²ç»è¶³å¤Ÿäº†ã€‚
ä½†ä½œä¸ºä¸€é—¨ç›¸å¯¹å°ä¼—çš„è¯­è¨€ï¼ˆä»¥åŠä¸ºäº†èƒ½è®©æ›´å¤šäººäº†è§£Rustï¼‰ï¼Œ
æˆ‘ä»¬è¿˜æ˜¯ä¸å¾—ä¸è®¨è®ºä¸€äº›ç»†èŠ‚çš„ä¸œè¥¿ã€‚&lt;/p>
&lt;h3 id="rust-çš„å¤§è‡´ç”»åƒ">Rust çš„å¤§è‡´ç”»åƒ
&lt;/h3>&lt;p>ä»¥é˜²ä½ å¯èƒ½ä¼šé—®ï¼šâ€œRust æœ‰ä»€ä¹ˆå¥½çš„ï¼Ÿâ€
ç±»ä¼¼è¿™æ ·çš„é—®é¢˜ï¼Œæˆ‘ä¼šå…ˆç®€è¦ä»‹ç»ä¸€ä¸‹Rustçš„å¤§è‡´ç”»åƒã€‚&lt;/p>
&lt;p>&lt;u>Rustæ˜¯ä¸€é—¨ï¼Œæ€§èƒ½è¶³ä»¥å’Œ C/C++ åª²ç¾çš„ï¼Œä¸»æ‰“&lt;strong>æ ‡å‡†ç°ä»£å·¥ç¨‹åŒ–&lt;/strong>çš„é™æ€ç¼–ç¨‹è¯­è¨€&lt;/u>ï¼Œ
ä¸ºäº†å®ç°é«˜æ•ˆçš„è¿è¡Œæ•ˆç‡å’Œè¶³å¤Ÿç°ä»£å’Œå®‰å…¨çš„å¼€å‘æµç¨‹ï¼Œ
Rustä¼šæ¯”ä»»ä½•åŒç±»å‹çš„ç¼–ç¨‹è¯­è¨€çœ‹ä¸Šå»æ›´åŠ ç¹çã€‚
å®ƒæ˜¯ä¸€ä¸ªè¾ƒå¥½çš„ C++ çš„åŒç±»æ›¿ä»£å“ï¼Œåœ¨è¾ƒä¸ºåŸºç¡€çš„æ¨¡å—ç¼–å†™ä¸Šï¼Œèƒ½å¤Ÿåšåˆ°éå¸¸ä¼˜ç§€çš„å·¥ç¨‹è¾“å‡ºã€‚
å¯¹äºä¸ç†Ÿæ‚‰ä½¿ç”¨ C++ è¿›è¡Œå·¥ç¨‹å¼€å‘çš„äººæ¥è¯´ï¼Œ
Rust é¡¹ç›®çš„å·¥å…·é“¾ï¼ˆcargoï¼‰æ›´å®¹æ˜“ä¸Šæ‰‹ï¼Œç¼–å†™çš„ä»£ç ä¹Ÿä¸å®¹æ˜“å‡ºé”™ã€‚&lt;/p>
&lt;p>è¯­æ³•å½¢å¼ä¸Š Rust å’Œ Typescriptã€Scala ç­‰è¯­è¨€ç±»ä¼¼ï¼Œ
ä½¿ç”¨è¿™äº›è¯­è¨€çš„é¢†åŸŸçš„ç¨‹åºå‘˜ä¼šæ›´å®¹æ˜“ä¸Šæ‰‹ Rustã€‚
ä½†åŒæ—¶ Rust çš„ unsafe ç‰¹æ€§åˆå¯ä»¥ä½¿å…¶ä¸‹æ¢åˆ°ç³»ç»Ÿçº§åˆ«çš„ç¼–ç¨‹é¢†åŸŸï¼Œ
è¿™äº›é¢†åŸŸä¹Ÿå¸¦æ¥ä¸€æ‰¹æ›´åŠ é«˜çº§çš„ç©æ³•ã€‚&lt;/p>
&lt;p>Rust çš„å¼€æºç¤¾åŒºç ´äº‹æ¯”è¾ƒå¤šï¼Œä½†ä¹Ÿç¡®å®æœ‰ä¸å°‘å¤§ä½¬ä¹Ÿå–œæ¬¢ä½¿ç”¨ Rustã€‚&lt;/p>
&lt;h4 id="æˆ‘çš„é¡¹ç›®ä¸ºä»€ä¹ˆé€‰æ‹©-rust">æˆ‘çš„é¡¹ç›®ä¸ºä»€ä¹ˆé€‰æ‹© Rust
&lt;/h4>&lt;p>å¯¹æˆ‘æ¥è¯´ Rust è¶³å¤Ÿå­˜ç²¹ï¼Œæˆ‘å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä»»ä½•åœºåˆï¼Œå¿«é€Ÿæ„å»º Rust çš„é¡¹ç›®ç¯å¢ƒ
ï¼ˆcargoã€VSCode+ æ’ä»¶ï¼‰ã€‚
cargo è¿™ä¸ªå·¥å…·å¯ä»¥å¸®åŠ©æˆ‘å¿«é€Ÿå¼•å…¥æˆ‘æƒ³è¦çš„ä¾èµ–ï¼Œç”Ÿæˆè¶³å¤Ÿæ¸…æ™°çš„æ–‡æ¡£ï¼Œå¹¶ä¸”åšå¥½æ¨¡å—åˆ’åˆ†ï¼Œ
ç›¸åæˆ‘å¯¹ C++ è¯¥å¦‚ä½•åšè¿™äº›äº‹æƒ…å¹¶ä¸éå¸¸ç†Ÿæ‚‰ã€‚
&lt;em>å¯¹äºæœªæ¥å‚ä¸è´¡çŒ®çš„äººæ¥è¯´ï¼Œæˆ‘å¸Œæœ›åœ¨æäº¤ä»£ç ä¹‹å‰å°±è§£å†³å¤§éƒ¨åˆ†æ½œåœ¨çš„ä»£ç é—®é¢˜ï¼Œ
Rust è¶³å¤Ÿå®‰å…¨çš„ç‰¹æ€§å¤§å¹…åº¦å‡è½»äº†æˆ‘çš„å¿ƒç†è´Ÿæ‹…ã€‚
ï¼ˆä½ å†™å‡ºæ¥çš„ä»£ç é€šå¸¸æ¥è¯´åªè¦é€šè¿‡ç¼–è¯‘ï¼Œå°±ä¸ä¼šäº§ç”Ÿä»»ä½•æ— æ³•è¿½æŸ¥çš„æ¶æ€§ BUGï¼‰&lt;/em>&lt;/p>
&lt;h3 id="rust-çš„å¼€å‘å·¥å…·é“¾">Rust çš„å¼€å‘å·¥å…·é“¾
&lt;/h3>&lt;p>å½“ä½ åœ¨é˜…è¯»æˆ–è€…å¼€å‘Rustç¨‹åºæ—¶ï¼Œä½ éœ€è¦å®‰è£…ï¼š&lt;/p>
&lt;ol>
&lt;li>rustupï¼ˆåŒ…å« cargoï¼‰&lt;a class="link" href="https://www.rust-lang.org/tools/install" target="_blank" rel="noopener"
>å®˜ç½‘åœ°å€&lt;/a>&lt;/li>
&lt;li>VSCode/Clion + Rust æ’ä»¶åŒ…ï¼ˆåŒ…å« rust-analyzerï¼‰ï¼ˆ+tabnine/copilotï¼‰&lt;/li>
&lt;/ol>
&lt;p>æ¥ä¸‹æ¥ä½ éœ€è¦æŒæ¡ Cargo çš„ä½¿ç”¨ï¼Œæ–‡æ¡£å¯ä»¥å‚è€ƒ&lt;a class="link" href="https://doc.rust-lang.org/cargo/" target="_blank" rel="noopener"
>Cargo Book&lt;/a>ã€‚
&lt;u>ä½ éœ€è¦çŸ¥é“å¦‚ä½•ä½¿ç”¨ &lt;code>cargo new/build/run/test + fmt/clippy&lt;/code> çš„ä½¿ç”¨ï¼Œå…¶ä¸­ fmt å’Œ clippy å¯ä»¥å¸®åŠ©ä½ ç¼–å†™æ›´ä¼˜ç§€çš„ä»£ç &lt;/u>ã€‚&lt;/p>
&lt;h3 id="rustçš„è¯­æ³•å’Œç‰¹æ€§">Rustçš„è¯­æ³•å’Œç‰¹æ€§
&lt;/h3>&lt;p>&lt;a class="link" href="https://doc.rust-lang.org/book/ch03-00-common-programming-concepts.html" target="_blank" rel="noopener"
>The Rust Programming Language&lt;/a>
æ˜¯ä½ åœ¨æ„Ÿåˆ°ç–‘æƒ‘æ—¶æœ€ä¼˜å…ˆå‚ç…§çš„èµ„æ–™ï¼Œè¿™æ˜¯æœ€å®˜æ–¹çš„è¯­æ³•æ•™ç¨‹ã€‚
ä½†æ­£å¦‚æˆ‘ä¹‹å‰è¯´çš„ä¸€æ ·ï¼Œæˆ‘å¹¶ä¸å»ºè®®ä½ åœ¨å®Œå…¨æ²¡æœ‰é¡¹ç›®ä½œä¸ºå‡ºå‘ç‚¹çš„æ—¶å€™å»é€šè¯»è¿™æœ¬ä¹¦ï¼Œ
è¿™å¾ˆæ¶ˆè€—æ—¶é—´ã€‚&lt;/p>
&lt;p>æ¥ä¸‹æ¥æˆ‘ä¼šåˆ—å‡ºä¸€äº›å°çš„ç« èŠ‚ï¼Œæ¥è§£é‡Šä¸€äº›ä½ éœ€è¦åœ¨å…¥é—¨æ—¶å°±ä¹ æƒ¯çš„çš„ Rust è¯­æ³•å’Œç‰¹æ€§ã€‚&lt;/p>
&lt;h4 id="commoné€šç”¨è¯­æ³•">ã€Commonã€‘é€šç”¨è¯­æ³•
&lt;/h4>&lt;p>è¿™ä¸ªç« èŠ‚åŒ…å«çš„æ˜¯å¦‚ä½•ç”³æ˜å˜é‡ï¼Œå¦‚ä½•ä½¿ç”¨æ³¨é‡Šå’Œå¾ªç¯ç­‰åœ¨å…¶ä»–ç¼–ç¨‹è¯­è¨€å½“ä¸­ä¹Ÿéå¸¸å¸¸è§çš„è¯­æ³•ã€‚
&lt;a class="link" href="https://doc.rust-lang.org/book/ch03-00-common-programming-concepts.html" target="_blank" rel="noopener"
>Common Programming Concepts&lt;/a>
å’Œå®ƒçš„å­ç« èŠ‚åŸºæœ¬å°±èƒ½è§£å†³æ‰€æœ‰è¿™äº›é—®é¢˜ï¼Œä½†æˆ‘åŒæ ·ä¸å»ºè®®ä½ ç›´æ¥é˜…è¯»è¿™äº›ç« èŠ‚ï¼Œ
åœ¨æˆ‘çœ‹æ¥è¿™äº›è¯­æ³•ç¨€ç–å¹³å¸¸ï¼Œç›´æ¥é˜…è¯»é€šå¸¸ä¹Ÿèƒ½ç†è§£å®ƒçš„å«ä¹‰ã€‚&lt;/p>
&lt;p>æœ‰å¯èƒ½ä¼šå¸¦æ¥å›°æ‰°çš„æ˜¯å£°æ˜ç›¸å…³çš„å†…å®¹ï¼Œä¸è¿‡ä½ åªéœ€è¦äº†è§£ä¸‹é¢è¿™äº›å°±è¶³å¤Ÿäº†ã€‚
å¦‚æœä½ æƒ³åˆ›å»ºä¸€ä¸ªç”±åå­—æŒ‡ä»£çš„å€¼ï¼Œåªè¦è¿™ä¹ˆå†™å°±å¯ä»¥äº†ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">let (mut) {value_name}: {type} = {value}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¦‚ä½ æ‰€è§ï¼Œç±»å‹å£°æ˜çš„ä½ç½®å’Œå…¶ä»–è¯­è¨€æ˜¯ç¨æœ‰åŒºåˆ«çš„ï¼Œæ˜¾ç„¶è¿™ä¸æ˜¯å¾ˆå½±å“ç†è§£
&lt;code>mut&lt;/code> ä½ å¯èƒ½ä¹‹å‰å¹¶æ²¡æœ‰è§è¿‡ï¼Œå®ƒçš„æ„æ€æ˜¯ mutableï¼Œ
å¦‚æœä½ æƒ³åˆ›å»ºçš„æ—¶ä¸€ä¸ªå˜é‡ï¼Œä½ éœ€è¦åœ¨å£°æ˜æ—¶æŒ‡å®š &lt;code>mut&lt;/code>ã€‚
&lt;u>Rust çš„è¯­æ³•æ˜¯ç›¸å¯¹ç¹å¤çš„ï¼Œ
è¿™ç§è®¾è®¡çš„ç›®çš„æ˜¯ä¸ºäº†è®©ç¼–å†™çš„äººæ—¶åˆ»æ¸…æ¥šï¼Œè‡ªå·±å…·ä½“åœ¨åšä»€ä¹ˆ&lt;/u>ã€‚&lt;/p>
&lt;h4 id="commonoption-å¯é€‰å˜é‡å…¥é—¨-enum-å’Œæ¨¡å¼åŒ¹é…">ã€Commonã€‘Option å¯é€‰å˜é‡ï¼ˆå…¥é—¨ Enum å’Œæ¨¡å¼åŒ¹é…ï¼‰
&lt;/h4>&lt;p>æˆ‘ä»¬å¼€å§‹æ¥è§¦ä¸€äº›çœŸæ­£å¥‡æ€ªçš„ä¸œè¥¿äº†ï¼Œ
å…¥é—¨ Rust ç¬¬ä¸€ä¸ªåæ¶ˆæ¯æ˜¯ï¼Œä½ å¯èƒ½ä¸ä¼šå†è§åˆ° &lt;code>Null&lt;/code> æˆ–è€… &lt;code>nil&lt;/code> äº†ã€‚
ï¼ˆè‡³äºä¸ºä»€ä¹ˆè¿™æ ·å¯ä»¥ç¿»é˜…è¿™ä¸ªç« èŠ‚ï¼š&lt;a class="link" href="https://doc.rust-lang.org/book/ch06-01-defining-an-enum.html#the-option-enum-and-its-advantages-over-null-values" target="_blank" rel="noopener"
>The Option Enum and Its Advantages Over Null Values&lt;/a>)
ä¸è¿‡å¥½åœ¨è¿™ä»¶äº‹å…¶å®æŒºå®¹æ˜“æ¥å—çš„ï¼Œ
Option ä¼šæ˜¯ä½ åœ¨ Rust å½“ä¸­æ¥è§¦çš„éå¸¸å¤šçš„ä¸€ç§æšä¸¾ç±»å‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">enum&lt;/span> &lt;span class="nb">Option&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">None&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Some&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>å¦‚æœä½ æŒæ¡å…¶ä»–è¯­è¨€ä¸­æ³›å‹çš„ä½¿ç”¨&lt;/strong>ï¼Œé‚£ä¹ˆä½ åº”è¯¥ä¸éš¾ç†è§£ä¸Šé¢çš„ä»£ç ã€‚&lt;/p>
&lt;blockquote>
&lt;p>å¦‚æœä½ å¹¶ä¸æ¸…æ¥šä»€ä¹ˆæ—¶æ³›å‹ï¼Œæˆ–è€…è¯´ä½ å®Œå…¨æ— æ³•ç†è§£&lt;code>&amp;lt;&amp;gt;&lt;/code>ï¼Œ
å¯ä»¥å…ˆå°è¯•é˜…è¯»
&lt;a class="link" href="https://doc.rust-lang.org/book/ch10-00-generics.html" target="_blank" rel="noopener"
>Generic Types, Traits, and Lifetimes&lt;/a>
ä¸­çš„ Generic éƒ¨åˆ†ï¼Œæˆ–è€…å°è¯•ä»å…¶ä»–è¯­è¨€ä¸­è·å–å‚è€ƒï¼Œè¯·ä¸€å®šè®°ä½ï¼Œä½ åªéœ€è¦æµ…æ˜¾åœ°ç†è§£å³å¯&lt;/p>
&lt;/blockquote>
&lt;p>åœ¨å±•å¼€ &lt;code>Option&lt;/code> åŒ…è£¹çš„å€¼æ—¶ï¼Œä½ åªä¼šé‡åˆ°ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯ &lt;code>None&lt;/code> ä¸€ç§æ˜¯æœ‰å€¼çš„ &lt;code>Some&lt;/code>ã€‚&lt;/p>
&lt;p>&lt;strong>é‚£ä¹ˆå¦‚ä½•å±•å¼€ä¸€ä¸ªEnumå‘¢ï¼Ÿ
å¸¸è§çš„æ–¹æ³•æœ‰ä¸¤ç§ ( &lt;code>match&lt;/code> å’Œ &lt;code>if let&lt;/code> )&lt;/strong>ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">config_max&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Some&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="k">u8&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">match&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">config_max&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Some&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">max&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;The maximum is configured to be &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">max&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">_&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">config_max&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Some&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="k">u8&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Some&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">max&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">config_max&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;The maximum is configured to be &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">max&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¯·ä¸€å®šå°è¯•ç”¨è‡ªç„¶è¯­è¨€çš„ç†è§£æ–¹å¼ç†è§£è¿™äº›ä»£ç ï¼Œæˆ‘è®¤ä¸ºè¿™äº›è®¾è®¡éƒ½æ˜¯è¶³å¤Ÿè‡ªç„¶çš„ï¼Œ
å½“æ²¡æšä¸¾ç±»å‹ä¸æ˜¯ Option æ—¶ä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨çš„ã€‚&lt;/p>
&lt;p>é€šå¸¸æ¥è¯´ï¼Œå½“ä½ åªä¸“æ³¨äºè§£å¼€ Enum å½“ä¸­ä¸€ç§æƒ…å†µçš„å€¼æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ &lt;code>if let&lt;/code> å¥å¼ï¼Œ
ä»è€Œç¼©å‡ä»£ç é‡ã€‚&lt;/p>
&lt;blockquote>
&lt;p>ä½ ä¸éœ€è¦æ‹…å¿ƒæ— æ³•æ­£ç¡®åœ°æŒ‘é€‰ &lt;code>match&lt;/code> å’Œ &lt;code>if let&lt;/code> å¥å¼ï¼Œ
å› ä¸ºä½ å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ &lt;code>cargo clippy&lt;/code> æ¥è·å–ä»£ç å»ºè®®ï¼Œ
å¦‚æœä½ çš„ &lt;code>match&lt;/code> æ—¶éå¸¸ç®€å•çš„åŒé¡¹é€‰æ‹©ï¼Œ &lt;code>cargo clippy&lt;/code> ä¼šå‘Šè¯‰ä½ å¦‚ä½•è½¬æ¢æˆ &lt;code>if let&lt;/code> çš„ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>æœ€åï¼Œè¿™éƒ¨åˆ†çš„æ‰€æœ‰å†…å®¹éƒ½åŒ…å«åœ¨ &lt;a class="link" href="https://doc.rust-lang.org/book/ch06-00-enums.html" target="_blank" rel="noopener"
>Enums and Pattern Matching&lt;/a>ä¸‹ã€‚&lt;/p>
&lt;h4 id="commonresult-é”™è¯¯å¤„ç†çš„å°é—®å·">ã€Commonã€‘Result é”™è¯¯å¤„ç†çš„å°é—®å·ï¼Ÿ
&lt;/h4>&lt;p>æ¥ä¸‹æ¥æˆ‘ä»¬è¦ç»§ç»­è®¤è¯†ä¸‹ä¸€ä¸ªç‰¹åˆ«çš„æšä¸¾ç±»å‹ &lt;code>Result&lt;/code>ã€‚
åœ¨è¿›è¡Œä¸‹é¢çš„é˜…è¯»ä¹‹å‰ï¼Œæˆ‘è®¤ä¸ºå¯ä»¥æé†’ä½ ä¸€äº›å°å…³é”®ç‚¹ï¼š
å¦‚ä½ æ‰€è§ï¼Œæˆ‘å•ç‹¬æ‹¿å‡ºæ¥ä¸¾ä¾‹çš„éƒ½æ˜¯ Enum çš„ç±»å‹ï¼Œ
è¿™å¯èƒ½ä¼šå¯¹è¯»è€…æœ‰ä¸€å®šçš„è¯¯å¯¼ï¼Œè®¤ä¸ºå®ƒä»¬å„è‡ªæ—¶ç‰¹æ®Šçš„ç±»å‹ã€‚
&lt;u>è¯·è®°ä½åŒä¸€ç§ç±»å‹å®ƒä»¬æ˜¯å…±äº«åŒä¸€ç§ç‰¹æ€§çš„ï¼Œå¦‚ &lt;code>match&lt;/code> å’Œ &lt;code>if let&lt;/code> å¯¹ä»»ä½• Enum éƒ½å¯ä»¥ä½¿ç”¨&lt;/u>&lt;/p>
&lt;p>å¯¹ Result æ¥è¯´å¯ä»¥å•ç‹¬æ‹¿å‡ºæ¥è®²çš„æ˜¯ &lt;code>?&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">use&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">fs&lt;/span>::&lt;span class="n">File&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">use&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">io&lt;/span>::&lt;span class="p">{&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Read&lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">read_username_from_file&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nb">Result&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nb">String&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">io&lt;/span>::&lt;span class="n">Error&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">username_file&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">File&lt;/span>::&lt;span class="n">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;hello.txt&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">String&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">username_file&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">read_to_string&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™æ˜¯Rustå½“ä¸­ä¸ŠæŠ›é”™è¯¯çš„ç®€æ˜“å†™æ³•ï¼Œ&lt;strong>å½“ä¸Šå±‚çš„ Result çš„æšä¸¾å¯ä»¥æå–ä¸ŠæŠ›çš„é”™è¯¯ç±»å‹æ—¶ï¼Œ
å°±å¯ä»¥ä½¿ç”¨ &lt;code>?&lt;/code> æ¥ä½¿ä»£ç åœ¨å‡½æ•°è¿”å› Error çš„æšä¸¾å€¼çš„æ—¶å€™ï¼Œç›´æ¥ return&lt;/strong>ã€‚&lt;/p>
&lt;blockquote>
&lt;p>è¯·æ³¨æ„ï¼Œ&lt;code>?&lt;/code> çš„ç”¨æ³•æ—¶å¯ä»¥ç”¨ &lt;code>match&lt;/code> è¿™ç§é€šç”¨æ–¹æ³•æ›¿ä»£çš„ï¼Œå®ƒå°±æ˜¯åœ¨åŒ¹é…åˆ° &lt;code>Err(_)&lt;/code> æ—¶ return çš„å«ä¹‰ã€‚&lt;/p>
&lt;/blockquote>
&lt;h4 id="commonç»“æ„ä½“å’Œé¢å‘å¯¹è±¡">ã€Commonã€‘ç»“æ„ä½“å’Œé¢å‘å¯¹è±¡
&lt;/h4>&lt;p>å¦‚æœä½ ä½¿ç”¨è¿‡ Golang è¿™æ ·çš„è¾ƒä¸ºæ–°å¼çš„ç¼–ç¨‹è¯­è¨€ï¼Œä½ å¯èƒ½å·²ç»æ¥å—äº†ä¸å®Œæ•´çš„é¢å‘å¯¹è±¡çš„ä½¿ç”¨ã€‚
Rust ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œ&lt;code>impl&lt;/code> å–ä»£äº† Golang ä¸­çš„æ¥å£ï¼Œä½¿ç”¨èµ·æ¥é€šå¸¸æ¯”ä¼ ç»Ÿçš„é¢å‘å¯¹è±¡æ›´åŠ ç®€æ˜“ã€‚&lt;/p>
&lt;p>æˆ‘è®¤ä¸ºåœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œä½ éœ€ä¸éœ€è¦æœ‰å¤ªå¤šçš„å­¦ä¹ è´Ÿæ‹…ï¼Œæ¯•ç«Ÿè¿™å—è®¾è®¡å¹¶ä¸æ˜¯éå¸¸æœ‰ç‰¹è‰²çš„ï¼Œ
å› è¯¥èƒ½å¿«é€Ÿé€‚åº”çš„ã€‚
ç›¸å…³çš„ç« èŠ‚åœ¨ï¼š&lt;a class="link" href="https://doc.rust-lang.org/book/ch05-00-structs.html" target="_blank" rel="noopener"
>Using Structs to Structure Related Data&lt;/a>ã€‚&lt;/p>
&lt;blockquote>
&lt;p>å¯¹ç»“æ„ä½“çš„ä½¿ç”¨æ›´å¤šæ˜¯åœ¨ç¨‹åºè®¾è®¡æ–¹é¢ï¼Œå‡ºè‰²çš„è®¾è®¡å¯ä»¥åˆ¶ä½œå‡ºä¼˜ç§€çš„ä»£ç æµï¼Œå¯ä»¥åˆ©ç”¨åˆ°å‡½æ•°å¼ç¼–ç¨‹è¿™ç§ä¼˜ç§€çš„ç¼–å†™æ–¹å¼ã€‚&lt;/p>
&lt;/blockquote>
&lt;h4 id="projectæ¨¡å—çš„ç¼–æ’">ã€Projectã€‘æ¨¡å—çš„ç¼–æ’
&lt;/h4>&lt;p>æˆ‘éå¸¸è®¨åŒå•æ–‡æœ¬ä»£ç ï¼Œä»£ç é‡ä¸€æ—¦å˜å¤§ï¼Œæˆ‘ä»¬å°±éœ€è¦æŠŠä»£ç æ‹†åˆ†æˆå¤šä¸ªæ–‡ä»¶ã€‚
è¿™å°±ä¼šéœ€è¦è€ƒè™‘æˆ‘ä»¬çš„ä»£ç æ˜¯å¦éœ€è¦è¿›è¡Œå…¬å¼€ï¼Œä»¥åŠå¦‚ä½•åœ¨å…¶ä»–åœ°æ–¹å¼•ç”¨å®ƒä»¬ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">use&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">crate&lt;/span>::&lt;span class="n">garden&lt;/span>::&lt;span class="n">vegetables&lt;/span>::&lt;span class="n">Asparagus&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mod&lt;/span> &lt;span class="nn">garden&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">plant&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Asparagus&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;I&amp;#39;m growing &lt;/span>&lt;span class="si">{:?}&lt;/span>&lt;span class="s">!&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">plant&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä½ éœ€è¦æŒæ¡ä¸¤ç§æ ‡è®°ï¼Œ&lt;code>pub&lt;/code> å’Œ &lt;code>use&lt;/code>ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>pub&lt;/code> å¾ˆå®¹æ˜“ç†è§£ï¼Œå°±æ˜¯å…¬å¼€æ¨¡å—ä¸­çš„æŸä¸ªå…ƒç´ ï¼ˆå…ƒç´ å¯ä»¥æ˜¯ï¼Œå‡½æ•°ã€ç»“æ„ä½“ã€ç»“æ„ä½“ä¸­çš„æˆå‘˜ç­‰ï¼‰&lt;/li>
&lt;li>&lt;code>use&lt;/code> ç”¨äºå¼•ç”¨æˆ‘ä»¬éœ€è¦ä½¿ç”¨çš„å…ƒç´ æ¨¡å—ï¼Œå…¶åä¼šè·Ÿéšä¸€ä¸²è·¯å¾„ï¼Œè·¯å¾„çš„å¼€å¤´å¯èƒ½ä¼šæœ‰äº›ç‰¹æ®Šçš„èµ·å§‹æ ‡è®°ï¼Œä¾‹å¦‚ &lt;code>crate&lt;/code> å’Œ &lt;code>super&lt;/code>ï¼Œå‰è€…æ˜¯é¡¹ç›®çš„èµ·å§‹è·¯å¾„æ ‡è®°ï¼Œåè€…æ˜¯åŒçº§æ¨¡å—çš„ç›¸å¯¹è·¯å¾„èµ·å§‹æ ‡è®°ã€‚&lt;/li>
&lt;/ul>
&lt;p>ä½ å¯ä»¥åœ¨é‡åˆ°ç–‘æƒ‘æ—¶å†ç¿»é˜…ä¸‹é¢çš„æ–‡æ¡£ &lt;a class="link" href="https://doc.rust-lang.org/book/ch07-02-defining-modules-to-control-scope-and-privacy.html?highlight=mod#modules-cheat-sheet" target="_blank" rel="noopener"
>Managing Growing Projects with Packages, Crates, and Modules&lt;/a>&lt;/p>
&lt;h4 id="magicç”Ÿå‘½å‘¨æœŸ">ã€Magicã€‘ç”Ÿå‘½å‘¨æœŸ
&lt;/h4>&lt;p>å‹è½´éƒ¨åˆ†ï¼Œä¹Ÿæ˜¯ Rust å½“ä¸­æœ€éš¾ä»¥ç†è§£çš„ç‰¹æ€§ä¹‹ä¸€ï¼Œå®ƒåœ¨æ•™ç¨‹çš„ç¬¬ä¸‰ç« å°±è¿›è¡Œäº†ä»‹ç»ï¼š
&lt;a class="link" href="https://doc.rust-lang.org/book/ch04-00-understanding-ownership.html" target="_blank" rel="noopener"
>Understanding Ownership&lt;/a>ã€‚
Rustè¿˜æœ‰ä¸€äº›å…¶ä»–çš„é«˜çº§ç”¨æ³•ï¼Œä½†ç”Ÿå‘½å‘¨æœŸæ˜¯ä½ å‡ ä¹æ— æ³•è§„é¿çš„ï¼Œ
å®ƒçš„å­˜åœ¨é€ å°±äº† Rust æ—¢å—æœ‰ç¼–å†™å®‰å…¨çš„ç‰¹å¾ï¼Œä¹Ÿä½¿ä»£ç çš„ç¼–å†™ä¸é‚£ä¹ˆé¡ºå¿ƒå¦‚æ„ã€‚&lt;/p>
&lt;p>åœ¨ Rust çš„è®¾è®¡å½“ä¸­ï¼Œ&lt;strong>ä»»ä½•éå¸¸é‡çš„å€¼ï¼Œé»˜è®¤åªå­˜æ´»äºå®ƒçš„ä½œç”¨åŸŸå½“ä¸­ï¼Œä¸”åªæœ‰ä¸€ä¸ªçœŸæ­£çš„å®ä½“&lt;/strong>ã€‚&lt;/p>
&lt;p>æˆ‘ç¨å¾®ä¿®æ”¹äº†ä¸€ä»½å®˜æ–¹çš„ä¾‹å­ï¼Œè¿™ä¸ªä¾‹å­åœ¨å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­é€šå¸¸æ˜¯èƒ½é€šè¿‡ç¼–è¯‘çš„ï¼Œä½†æ˜¯ Rust ä¸è¡Œã€‚
åŸå› å°±æ˜¯ä¸Šé¢çš„è§„çº¦é€ æˆçš„ï¼Œåœ¨ &lt;code>let s3 = takes_and_gives_back(s2);&lt;/code> æ‰§è¡Œæ—¶ï¼Œ&lt;code>s2&lt;/code> çš„å®ä½“å·²ç»å‘ç”Ÿäº†è½¬ç§»ã€‚&lt;/p>
&lt;blockquote>
&lt;p>Rust çš„ç¼–å†™è¿‡ç¨‹å½“ä¸­ï¼Œéå¸¸å¤§éƒ¨åˆ†çš„ç¼–è¯‘æŠ¥é”™éƒ½æ˜¯ç”±ä¸åˆæ³•çš„ç”Ÿå‘½å‘¨æœŸé€ æˆçš„ã€‚
å¯¹æ­¤ä½ éœ€è¦é¢å¤–åœ°è¿›è¡Œä¸€äº›é€‚åº”ï¼Œä½†è¯·ç†è§£ï¼Œè¿™ä¹Ÿå¯ä»¥å¸®åŠ©ä½ åœ¨è¾ƒä½çš„å…³æ³¨æˆæœ¬ä¸‹å…³æ³¨åˆ°æ¯ä¸ªå€¼çš„åˆ†é…å’Œé‡Šæ”¾çš„æƒ…å†µã€‚&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">gives_ownership&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// gives_ownership moves its return
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// value into s1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s2&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">String&lt;/span>::&lt;span class="n">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;hello&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// s2 comes into scope
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s3&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">takes_and_gives_back&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">s2&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// s2 is moved into
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// takes_and_gives_back, which also
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// moves its return value into s3
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// !!! WILL FAILED TO COMPILE !!!
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s4&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">takes_and_gives_back&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">s2&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// Here, s3 goes out of scope and is dropped. s2 was moved, so nothing
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// happens. s1 goes out of scope and is dropped.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">gives_ownership&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nb">String&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// gives_ownership will move its
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// return value into the function
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// that calls it
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">some_string&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">String&lt;/span>::&lt;span class="n">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;yours&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// some_string comes into scope
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">some_string&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// some_string is returned and
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// moves out to the calling
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// function
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="c1">// This function takes a String and returns one
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">takes_and_gives_back&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">a_string&lt;/span>: &lt;span class="nb">String&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nb">String&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// a_string comes into
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// scope
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">a_string&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// a_string is returned and moves out to the calling function
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¦ä¿®å¤ä¸Šé¢çš„ç¼–è¯‘æŠ¥é”™ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€å¯¹ s2 è¿›è¡Œæ‹·è´å³å¯ &lt;code>let s3 = takes_and_gives_back(s2.clone());&lt;/code> ã€‚
&lt;em>åœ¨å¾ˆå¤šè¯­è¨€ï¼Œä¾‹å¦‚ Golang å’Œ Java ä¸­è¿™ä¸€åŠ¨ä½œæ˜¯è‡ªåŠ¨å‘ç”Ÿçš„ï¼Œ
è€Œåœ¨ Rust å½“ä¸­ï¼Œä½ éœ€è¦åœ¨ä»£ç ä¸­ä½“ç°è¿™ä¸€ä¸ªåŠ¨ä½œã€‚&lt;/em>&lt;/p>
&lt;h4 id="magicå®å’Œä»£ç ç”Ÿæˆ">ã€Magicã€‘å®å’Œä»£ç ç”Ÿæˆ
&lt;/h4>&lt;p>å®æ˜¯ Rust çš„ä¸€ç§é«˜çº§ç‰¹æ€§ï¼Œä½†ä½œä¸ºå…¥é—¨è€…ä½ ä¸éœ€è¦è¿‡äºæ‹…å¿ƒï¼Œæˆ‘ä¸æ›¾æ·±å…¥è¿‡å®çš„ä½¿ç”¨ï¼Œ
åœ¨è¿™é‡Œæåˆ°å®ï¼Œä»…ä»…æ˜¯å› ä¸ºä½ ä¼šåœ¨ä»£ç é‡Œçœ‹åˆ°å®ƒä»¬ï¼Œå®ƒèƒ½æä¾›æ›´åŠ çµæ´»çš„åŠŸèƒ½æ„å»ºï¼Œä¸ºä»£ç çš„ç¼–å†™å¸¦æ¥ä¾¿åˆ©ã€‚
ä½œä¸ºä½¿ç”¨è€…ï¼Œæˆ‘é€šå¸¸ç”¨å®ƒå®Œæˆè¾“å…¥è¾“å‡ºæ—¥å¿—ã€æ ¼å¼åŒ–å­—ç¬¦ä¸²ã€æ·»åŠ ï¼ˆåï¼‰åºåˆ—åŒ–ã€ç¼–å†™ WebHandler ç­‰é«˜çº§åŠŸèƒ½ã€‚&lt;/p>
&lt;p>å®ä¼šä»¥ä¸‰ç§å½¢å¼å‡ºç°ï¼š&lt;/p>
&lt;ol>
&lt;li>&lt;code>macro_name!(...)&lt;/code> è¿™ç§å®çš„ä½¿ç”¨æ— å¼‚äºå‡½æ•°ï¼Œä¹Ÿå«åšå‡½æ•°å®ï¼Œåªæ˜¯åœ¨å‡½æ•°ååæœ‰ &lt;code>!&lt;/code> æ ‡æ³¨ï¼Œ
å®ƒèƒ½å¸¦æ¥æ¯”å‡½æ•°æ›´åŠ çµæ´»çš„ä½¿ç”¨ï¼Œå…¸å‹çš„ä»£è¡¨å°±æ˜¯ &lt;code>format!/println!()&lt;/code> å®ã€‚&lt;/li>
&lt;li>&lt;code>#[...]&lt;/code> å¦‚æœä½ æ¥è§¦è¿‡ C# çš„ Attributeï¼Œç†è§£è¿™ç§å®ä¼šæ›´åŠ ç®€å•ï¼Œå®ƒå«å±æ€§å®ï¼Œå¯ä»¥å‡ºç°åœ¨éå¸¸å¤šçš„ä»£ç å—çš„å¤´éƒ¨
ï¼ˆæ¯”å¦‚ Enumã€structã€func ç­‰ï¼Œä¹Ÿå¯ä»¥å‡ºç°åœ¨æ–‡ä»¶çš„å¤´éƒ¨ï¼‰ä¸ºè¿™äº›ä»£ç å—æ·»åŠ å±æ€§ï¼Œå¯ä»¥ä½¿ä»£ç å—è·å¾—é¢å¤–çš„èƒ½åŠ›&lt;/li>
&lt;li>&lt;code>#[derive(...)]&lt;/code> ä½ å¯ä»¥ç†è§£æ´¾ç”Ÿå®ä¸ºä¸€ç§ç‰¹æ®Šçš„å±æ€§å®ï¼Œä½†å®ƒåªèƒ½ä½œç”¨äº Enum å’Œ struct ä¹‹ä¸Š&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>ä½ å¯ä»¥ç†è§£å®æ˜¯é€šè¿‡æŸç§å£°æ˜å®ç°çš„ Rust ä»£ç çš„ç”Ÿæˆèƒ½åŠ›ï¼Œå®åœ¨ç¼–è¯‘æ—¶ä¼šåœ¨ target å½“ä¸­è‡ªåŠ¨ç”Ÿæˆä¸€ä¸²ç›¸åº”çš„ä»£ç ï¼Œ
é€šå¸¸æ¥è¯´ä½ ä¸éœ€è¦äº†è§£å…·ä½“å®ƒä»¬æ˜¯å¦‚ä½•ç”Ÿæˆçš„ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>æ›´å¤šå¯ä»¥å‚è€ƒæ–‡æ¡£ &lt;a class="link" href="https://doc.rust-lang.org/book/ch19-06-macros.html?highlight=macro#macros" target="_blank" rel="noopener"
>Macros&lt;/a>&lt;/p>
&lt;h2 id="ç»“è¯­">ç»“è¯­
&lt;/h2>&lt;p>ä»¥ä¸Šå°±æ˜¯æˆ‘è®¤ä¸ºä½ éœ€è¦å¿«é€Ÿå­¦ä¹  Rust æ‰€éœ€è¦çš„å…¨éƒ¨äº†ï¼Œ
åœ¨æœ€åæˆ‘å¯¹è‡ªå·±æ‰€å†™çš„å†…å®¹è¿›è¡Œä¸€äº›åæ€ã€‚&lt;/p>
&lt;p>æˆ‘è¯•å›¾è®© Rust çš„å…·ä½“éƒ¨åˆ†å˜å¾—æ›´åŠ åœ°ç®€çŸ­æ˜“æ‡‚ï¼Œå•æˆ‘ä¸è®¤ä¸ºæˆ‘åšçš„éå¸¸å‡ºè‰²ã€‚
æˆ‘é€šè¿‡æ¥å—éš¾æ˜“ç¨‹åº¦ï¼Œå¯¹è¯­æ³•å’Œç‰¹æ€§è¿›è¡Œäº†æ’åˆ—ï¼Œä½†çŸ¥è¯†ç»“æ„ä¾æ—§æ˜¾å¾—è¾ƒä¸ºå¹³é¢ã€‚&lt;/p>
&lt;p>æ‰€ä»¥åœ¨æœ€åï¼Œæˆ‘ä¸ºæ¯ä¸ªå°ç« èŠ‚åŠ ä¸Šäº†æ ‡å¤´ï¼ŒCommonã€Projectã€Magicï¼Œ
æˆ‘è®¤ä¸ºåœ¨ä»»ä½•è¯­è¨€æ—¶ï¼Œå¯ä»¥å¯¹è¯­æ³•å’Œç‰¹æ€§è¿›è¡Œè¿™ä¸‰å¤§å—çš„åˆ†ç±»ï¼Œ
å…¶ä¸­å‰ä¸¤è€…é€šå¸¸ä¸ä¼šå¸¦æ¥è¾ƒå¤šçš„å­¦ä¹ æˆæœ¬ï¼Œ
è€Œ Magicæ˜¯å¯èƒ½å¸¦æ¥å›°æ‰°ï¼Œä½†ä¹Ÿæ˜¯çœŸæ­£èƒ½äº§ç”Ÿå·®å¼‚çš„éƒ¨åˆ†ï¼ˆä¾‹å¦‚ Golang çš„åç¨‹ï¼ŒJS/TS çš„ Promise ç­‰ï¼‰ã€‚
&lt;u>åœ¨æ¶ˆåŒ–Magicéƒ¨åˆ†çš„å†…å®¹æ—¶ï¼Œè¯·åŠ¡å¿…æ˜ç™½å®ƒè§£å†³çš„æ˜¯ä»€ä¹ˆæ ·çš„ä¸€ä¸ªé—®é¢˜&lt;/u>ã€‚&lt;/p>
&lt;p>æˆ‘åœ¨æ–‡ç« ä¸­æœ‰å¤§é‡çš„å†…å®¹æåˆ°äº†ï¼Œæˆ‘ä¸å¸Œæœ›å„ä½åœ¨å…¥é—¨æ—¶å°±å¯¹ç‰¹æ€§è¿›è¡Œè¿‡å¤šçš„æ·±æŒ–ï¼Œ
å› ä¸ºè¿™æ˜¯ä¸€ç§å¾ˆæ¶ˆè€—æ—¶é—´çš„è¡Œä¸ºï¼Œä½†å¹¶ä¸æ˜¯è¯´å®Œå…¨æ‹’ç»ç±»ä¼¼æºç é˜…è¯»è¿™æ ·çš„äº‹æƒ…ã€‚
åªæ˜¯è¿™äº›äº‹æƒ…é€šå¸¸ä¸åº”è¯¥åœ¨åˆå­¦æ—¶å°±å‘ç”Ÿï¼Œä½†å¦‚æœä½ æ˜¯ä½ç›¸å…³ç»éªŒè¾ƒä¸ºä¸°å¯Œçš„â€œåˆå­¦è€…â€ï¼Œ
é˜…è¯»æºç ä¹Ÿæ˜¯è¢«å…è®¸çš„ï¼Œè¿™å¯èƒ½å¯ä»¥å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ä¸€äº›äº‹æƒ…ã€‚&lt;/p>
&lt;p>(å…¨æ–‡ç»ˆ)&lt;/p>
&lt;p>ğŸ˜© å†™çš„å¥½ç´¯ï¼Œå¸Œæœ›å„ä½å–œæ¬¢ ğŸ’•&lt;/p>
&lt;p>ğŸ“• ~æ¬¢è¿åœ¨è¯„è®ºåŒºç»™æˆ‘ç•™è¨€~ âŒ¨ï¸&lt;/p></description></item><item><title>Golang ç”Ÿäº§æ¶ˆè´¹æ§åˆ¶æ¨¡å‹</title><link>https://slhmy.github.io/blog/zh-cn/p/go-pc-control-model/</link><pubDate>Sat, 03 Sep 2022 11:09:00 +0800</pubDate><guid>https://slhmy.github.io/blog/zh-cn/p/go-pc-control-model/</guid><description>&lt;img src="https://slhmy.github.io/blog/zh-cn/p/go-pc-control-model/cover.png" alt="Featured image of post Golang ç”Ÿäº§æ¶ˆè´¹æ§åˆ¶æ¨¡å‹" />&lt;p>&lt;strong>å‰æƒ…æè¦æ˜¯è¿™æ ·çš„ï¼š&lt;/strong>&lt;/p>
&lt;p>æˆ‘æ˜¨å¤©å‚åŠ äº†æˆ‘éå¸¸å–œæ¬¢çš„æŸå…¬å¸çš„å…¨æ ˆå¼€å‘å·¥ç¨‹å¸ˆçš„é¢è¯•ï¼Œ
åœ¨ä»‹ç»äº†æˆ‘å„ç§è¿‡å¾€å¥‡å¥‡æ€ªæ€ªçš„ï¼ˆçœŸçš„æ˜¯éå¸¸å¥‡æ€ªçš„ï¼Œé¢è¯•å®˜å¬äº†ä»¥åç›´çš±çœ‰ğŸ˜‚ï¼‰é¡¹ç›®ä¹‹åï¼Œ
é¢è¯•å®˜å¼€å§‹è€ƒæ ¸æˆ‘çš„ä¸€äº›å®æˆ˜èƒ½åŠ›ã€‚
ç„¶åä¸Šæ¥çš„ç¬¬ä¸€é“ä»£ç è®¾è®¡çš„é¢˜ç›®å°±æŠŠæˆ‘è€ƒåˆ°äº†ï¼Œ&lt;strong>è¦æˆ‘ç”¨åç¨‹å®ç°å¤šç”Ÿäº§å¤šæ¶ˆè´¹ï¼Œå¹¶ä¸”èƒ½æ§åˆ¶åç¨‹åˆ›å»ºé€€å‡º&lt;/strong>ã€‚&lt;/p>
&lt;p>å¯èƒ½æ˜¯æˆ‘ Golang åªæ¥è§¦äº†ä¸€ä¸ªæœˆå·¦å³çš„æ—¶é—´ï¼Œ
è™½ç„¶ä¹‹å‰ç¡®å®æœ‰ä¸€æ¬¡è¢«è€ƒåˆ° &lt;code>channel&lt;/code> çš„ç”¨æ³•ï¼ˆä½†å¤ç›˜çš„æ—¶å€™ä¹Ÿå°±æ˜¯ç®€å•è¡¥ä¹ äº†ä¸€ä¸‹ &lt;code>make channel&lt;/code>ï¼‰ã€‚
è¿™æ¬¡ä¸Šæ¥ç›´æ¥åŠ¨æ‰‹è¦å†™ä»£ç ï¼Œè¿˜æ˜¯å¾ˆå¤šååº”ä¸è¿‡æ¥ï¼Œæˆ‘ç›´æ¥å°±å¯„äº†&amp;hellip;
æŸ¥äº†ä¸€ä¼š &lt;code>channel&lt;/code> çš„ç”¨æ³•ï¼Œåé¢æ†‹å‡ºå‡ è¡Œåˆå‘ç°ä¸ºäº†ä¸è®©è¿›ç¨‹è¿‡æ—©é€€å‡ºè¿˜è¦ä½¿ç”¨ &lt;code>waitGroup&lt;/code> è¿™äº›ğŸ˜‡ã€‚
ç„¶åä¸Šé¢è¯´åˆ°çš„æ¨¡å‹ç¡®å®æ¯”è¾ƒé‡è¦çš„ï¼Œæ¯•ç«Ÿæˆ‘ç®€å†ä¸Šä¹Ÿå¹å˜˜è‡ªå·±æŒæ¡å„ç§å¼‚æ­¥ä»»åŠ¡è®¾è®¡&amp;hellip;
ç»“æœå°±æ˜¯å•ªå•ªæ‰“è„¸ã€‚&lt;/p>
&lt;p>äºæ˜¯åœ¨è¿™åœºè¢«è™çš„éå¸¸æƒ¨çƒˆçš„é¢è¯•ä¹‹åï¼Œæˆ‘å†³å®šæŠŠè¿™æ ·ä¸€ä¸ªç”Ÿäº§æ¶ˆè´¹æ¨¡å‹å¥½å¥½è¡¥ä¸€ä¸‹ã€‚
æœ€åè¡¥ä¹ å®Œäº†ä»¥åå‘ç°ï¼Œå¤§é‡çš„å†…å®¹è¿˜æ˜¯è·Ÿ Golang çš„ &lt;code>channel&lt;/code> ç”¨æ³•æœ‰å…³ï¼Œé‚£ä¹ˆè¿™ç¯‡æ–‡ç« å°±ä¸»è¦å¯¹å…¶åšä¸€ä¸ªæ¢³ç†ã€‚&lt;/p>
&lt;h2 id="åŸºç¡€">åŸºç¡€
&lt;/h2>&lt;p>æˆ‘ä¸ä¼šè®²å¤ªå¤šï¼Œå› ä¸ºå¾ˆå¤šåœ°æ–¹å¯ä»¥æŸ¥åˆ°ï¼Œä»‹ç»çš„è‚¯å®šä¹Ÿæ›´è¯¦ç»†ã€‚
è¿™é‡Œåªæ˜¯æä¾›ä¸€ä¸ªè¾ƒå¿«çš„äº†è§£ã€‚&lt;/p>
&lt;h3 id="channel">channel
&lt;/h3>&lt;p>é¦–å…ˆå¯¹ channel éœ€è¦æŒæ¡å®ƒçš„ç±»å‹å£°æ˜ã€åˆ›å»ºå’Œæ“ä½œæ–¹æ³•ã€‚&lt;/p>
&lt;h4 id="channelçš„ç±»å‹å£°æ˜">channelçš„ç±»å‹å£°æ˜
&lt;/h4>&lt;p>åœ¨Golangå½“ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ &lt;code>[VARIABLE NAME] &amp;lt;-chan | chan | chan&amp;lt;- [TYPE]&lt;/code> è¿™æ ·çš„å¥å¼æ¥å£°æ˜ä¸€ä¸ª &lt;code>channel&lt;/code> å’Œå®ƒå†…éƒ¨çš„æ•°æ®ç±»å‹ã€‚
è¿™é‡Œ &lt;code>chan&lt;/code> æœ‰ç‚¹åƒä¸€ä¸ªå‰ç¼€çš„ä¿®é¥°è¯ï¼Œå¯èƒ½ç”±äºæ˜¯å…³é”®å­—çš„åŸå› ï¼Œåœ¨ç”¨æ³•ä¸Šå’Œæ™®é€šæ³›å‹ä¸Šæœ‰åŒºåˆ†ã€‚
æˆ‘è®¤ä¸ºå…³é”®æ˜¯è¦ä½¿ç”¨&lt;strong>è±¡å½¢&lt;/strong>çš„è®°å¿†æ–¹å¼ï¼ŒæŠŠ &lt;code>chan&lt;/code> æœ¬èº«å°±æƒ³è±¡æˆä¸€ä¸ªç®¡é“ï¼Œä½ å¯ä»¥åœ¨ &lt;code>chan&lt;/code> çš„ä¸¤ä¾§ç”¨ &lt;code>&amp;lt;-&lt;/code> æ¥æ ‡è®° &lt;code>chan&lt;/code> åœ¨è¿™ä¸ªä½œç”¨åŸŸä¸­çš„å¯ä»¥ä½¿ç”¨çš„ç«¯å£æ˜¯å†™ç«¯è¿˜æ˜¯è¯»ç«¯ï¼Œæ²¡æœ‰æ ‡è®°æ—¶ä»£è¡¨å…è®¸åŒç«¯çš„æ“ä½œ&lt;/p>
&lt;h4 id="channelçš„åˆ›å»º">channelçš„åˆ›å»º
&lt;/h4>&lt;p>é€šè¿‡ &lt;code>make&lt;/code> æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ª &lt;code>channel&lt;/code> ï¼Œè¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯ &lt;code>make&lt;/code> åˆ†é…çš„å®¹é‡æ˜¯æ ¹æ®å¯¹è±¡çš„åŸå­ä¸ªæ•°åˆ†é…çš„ã€‚
åƒ &lt;code>string&lt;/code> ç±»å‹ï¼Œåˆ†é…çš„æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œè¿™é‡Œæ˜¯å®¹æ˜“ç†è§£é”™çš„ã€‚
ä½†å¦‚æœä½ æ˜¯åˆ›å»ºçš„ä¸€ä¸ª &lt;code>struct&lt;/code>ï¼Œé‚£åˆ†é…çš„å®¹é‡æ˜¯â€œå¤šå°‘ä¸ªstructâ€ã€‚&lt;/p>
&lt;h4 id="channelçš„æ“ä½œ">channelçš„æ“ä½œ
&lt;/h4>&lt;p>&lt;code>chan&lt;/code> æœ€åŸºæœ¬çš„æ“ä½œå°±æ˜¯å†™å€¼å’Œå–å€¼æ“ä½œã€‚&lt;/p>
&lt;p>å†™å€¼çš„è¯­æ³•æ˜¯ &lt;code>[CHANNEL] &amp;lt;- [VARIABLE] | [VALUE]&lt;/code>ï¼Œæ˜¯è±¡å½¢çš„æ“ä½œæ–¹å¼ã€‚&lt;/p>
&lt;p>å–å€¼çš„è¯­æ³•æ˜¯ &lt;code>[VARIABLE] := &amp;lt;-[CHANNEL]&lt;/code>ï¼Œä»£è¡¨ä»å†™ç«¯å–å€¼ï¼Œ
æ­¤å¤–è¿˜æœ‰å’Œ &lt;code>range&lt;/code> ä¸€èµ·ä½¿ç”¨çš„ä¸€äº›è¯­æ³•ç³–ï¼ˆè¿™é‡Œå°±ä¸è¿‡å¤šä»‹ç»äº†ï¼‰ã€‚&lt;/p>
&lt;h3 id="context">Context
&lt;/h3>&lt;p>&lt;code>Context&lt;/code> çš„ä¸­æ–‡å«ä¹‰æ˜¯ä¸Šä¸‹æ–‡ï¼Œè¿™ç±»è®¾è®¡å…¶å®åœ¨å¾ˆå¤šæœåŠ¡æ¡†æ¶ä¸­æœ‰åšåˆ°ã€‚
åƒåœ¨Rustçš„ä¸€äº›Webæ¡†æ¶ä¸­ï¼Œä¼šæœ‰ &lt;code>app.data&lt;/code> çš„è®¾è®¡ï¼Œè¿™æ ·åšçš„ç›®çš„ä¸»è¦å°±æ˜¯æ–¹ä¾¿çº¿ç¨‹/åç¨‹ä¹‹é—´å®ç°æ•°æ®çš„å…±äº«ã€‚&lt;/p>
&lt;p>åœ¨Golangå½“ä¸­ï¼Œæˆ‘è®¤ä¸º &lt;code>Context&lt;/code> ä¹Ÿèµ·åˆ°äº†ç±»ä¼¼çš„ä½œç”¨ã€‚
ä½†åœ¨è¿™æ ·ä¸€ä¸ªåŠŸèƒ½çš„åŸºç¡€ä¸Šï¼Œ&lt;code>Context&lt;/code> è¿˜æä¾›äº†ä¸€äº›ç‰¹æ®Šå­—æ®µå’Œæ§åˆ¶æ–¹æ³•ï¼Œç”¨æ¥å®ç°å¯¹åç¨‹çš„æ§åˆ¶ã€‚
æœ€é‡è¦çš„ä¸€ç§ç”¨æ³•å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="k">select&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">case&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">ctx&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Done&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">default&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// normal works when this goroutine is up
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æˆ‘ä»¬é€šè¿‡ &lt;code>ctx.Done&lt;/code> è¿™ä¸ªç®¡é“æ¥åˆ¤æ–­åç¨‹æ˜¯å¦éœ€è¦ç»ˆæ­¢ï¼Œ
è¿™ä¸ªç®¡é“çš„æ¶ˆæ¯å¯ä»¥é€šè¿‡è®¾ç½® &lt;code>TimeOut&lt;/code> æˆ–è€…æ‰‹åŠ¨ &lt;code>cancel&lt;/code> ç­‰æ–¹æ³•æ¥å‘é€ã€‚
å…·ä½“å¯ä»¥æŸ¥é˜…ç›¸å…³çš„èµ„æ–™ã€‚&lt;/p>
&lt;h2 id="practice">Practice
&lt;/h2>&lt;p>æœ€åæˆ‘ä»¬æ¥æä¸€ä¸‹å¤šç”Ÿäº§å¤šæ¶ˆè´¹è¿™ä¸ªæ¨¡å‹çš„å®è·µã€‚
æ€è·¯å…¶å®å¾ˆç®€å•ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª &lt;code>channel&lt;/code> æ¥ä½œä¸ºæ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¦å¤–æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ª &lt;code>Context&lt;/code> æ¥æ§åˆ¶åç¨‹çš„é€€å‡ºã€‚&lt;/p>
&lt;p>æˆ‘ä»¬é¦–å…ˆå®šä¹‰æ¶ˆæ¯çš„æ ¼å¼ï¼Œå¹¶å‡†å¤‡ &lt;code>channel&lt;/code> å’Œ &lt;code>Context&lt;/code>ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="nx">Message&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Content&lt;/span> &lt;span class="kt">string&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">ctx&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">cancel&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">context&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">WithCancel&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">context&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Background&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">dataChannel&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="nx">Message&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">countChannel&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>dataChannel&lt;/code> æ˜¯ç”¨æ¥ç”Ÿäº§çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œ&lt;code>countChannel&lt;/code> æ˜¯ç”Ÿäº§è€…ä¹‹é—´ç”¨æ¥ååŒæ§åˆ¶æ¶ˆæ¯å·çš„ã€‚
ç”±äº &lt;code>countChannel&lt;/code> çš„è¯»å†™ä¼šå‘ç”Ÿåœ¨ä¸€ä¸ªç”Ÿäº§è€…å½“ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€ä¸ªå¤§å°ä¸º1çš„ç¼“å†²ï¼Œ
æ¯æ¬¡ç”Ÿäº§è€…è¿›è¡Œç”Ÿäº§ä¹‹å‰ï¼Œç”Ÿäº§è€…ä¼šå…ˆè¯»å–ç¼“å†²ä¸­çš„å€¼ï¼Œå¹¶æŠŠæœ€æ–°çš„æ¶ˆæ¯å·æ›´æ–°ã€‚&lt;/p>
&lt;p>æœ€åç»“åˆ &lt;code>Context&lt;/code> çš„åŸºæœ¬ç”¨æ³•ï¼Œæˆ‘ä»¬å¾—åˆ°çš„æ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼š&lt;/p>
&lt;h3 id="producer-æ ¸å¿ƒé€»è¾‘">Producer æ ¸å¿ƒé€»è¾‘
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="k">select&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// Handle &amp;lt;-ctx.Done()
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">case&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">ctx&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Done&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Producer_%d quit\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">id&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">default&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Get message count
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">Count&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">countCh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Count&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">countCh&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">Count&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Produce
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">dataCh&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">Message&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Content&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Producer_%d sending message_%d&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">id&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Count&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Second&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="consumer-æ ¸å¿ƒé€»è¾‘">Consumer æ ¸å¿ƒé€»è¾‘
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// Consume
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">data&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">dataCh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Consumer_%d get message: %s\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">id&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">data&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Content&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>React åŸºç¡€</title><link>https://slhmy.github.io/blog/zh-cn/p/react-hooks/</link><pubDate>Wed, 31 Aug 2022 19:00:00 +0800</pubDate><guid>https://slhmy.github.io/blog/zh-cn/p/react-hooks/</guid><description>&lt;h2 id="hooks">Hooks
&lt;/h2>&lt;p>&lt;a class="link" href="https://zhuanlan.zhihu.com/p/443264124" target="_blank" rel="noopener"
>ã€çŸ¥ä¹ã€‘react-hooksåŸç†è§£æ&lt;/a>&lt;/p>
&lt;p>å¸¸è§é’©å­ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>useState&lt;/code>&lt;/li>
&lt;li>&lt;code>useEffect&lt;/code>&lt;/li>
&lt;li>&lt;code>useContext&lt;/code>&lt;/li>
&lt;li>&lt;code>useReducer&lt;/code>&lt;/li>
&lt;li>&lt;code>useRef&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>ç”Ÿå‘½å‘¨æœŸï¼šæŒ‚è½½ &amp;ndash;&amp;gt; æ›´æ–° &amp;ndash;&amp;gt; å¸è½½&lt;/p>
&lt;h2 id="virtual-dom">Virtual Dom
&lt;/h2>&lt;p>å‚è€ƒé“¾æ¥ï¼š
&lt;a class="link" href="https://zhuanlan.zhihu.com/p/462727885" target="_blank" rel="noopener"
>ã€çŸ¥ä¹ã€‘å‰–æReactæ ¸å¿ƒè®¾è®¡åŸç†&amp;ndash;Virtual Dom&lt;/a>&lt;/p>
&lt;h3 id="virtual-domçš„ä½œç”¨">Virtual Domçš„ä½œç”¨
&lt;/h3>&lt;p>Virtual Domæ˜¯å¯¹HTML Domçš„JavaScriptå½¢å¼çš„å°è£…&lt;/p>
&lt;blockquote>
&lt;p>Virtual DOMæ˜¯ä¸€ç§ç¼–ç¨‹æ–¹å¼ï¼Œå®ƒä»¥å¯¹è±¡çš„å½¢å¼ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œå®ƒæè¿°äº†æˆ‘ä»¬DOMçš„å¿…è¦ä¿¡æ¯ï¼Œå¹¶ä¸”ç”¨ç±»ä¼¼react-domç­‰æ¨¡å—ä¸çœŸå®DOMåŒæ­¥ï¼Œè¿™ä¸€è¿‡ç¨‹ä¹Ÿå«åè°ƒ(reconciler)ï¼Œè¿™ç§æ–¹å¼å¯ä»¥å£°æ˜å¼çš„æ¸²æŸ“ç›¸åº”çš„uiçŠ¶æ€ï¼Œè®©æˆ‘ä»¬ä»DOMæ“ä½œä¸­è§£æ”¾å‡ºæ¥&lt;/p>
&lt;/blockquote>
&lt;p>æˆ‘ç†è§£æœ‰äº†Virtual Domä¹‹åï¼Œå¼±åŒ–äº†å¼€å‘è€…å¯¹äºåŸç”ŸHTML Domçš„æ„ŸçŸ¥ï¼Œè¿™æ ·æ›´æ–¹ä¾¿æˆ‘ä»¬åœ¨JavaScriptå±‚é¢å»ä¿®æ”¹é¡µé¢çš„åŠ¨æ€å…ƒç´ ã€‚&lt;/p></description></item></channel></rss>