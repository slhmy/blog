<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Goroutine on slhmy çš„åšå®¢</title><link>https://slhmy.github.io/blog/zh-cn/tags/goroutine/</link><description>Recent content in Goroutine on slhmy çš„åšå®¢</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Sat, 03 Sep 2022 11:09:00 +0800</lastBuildDate><atom:link href="https://slhmy.github.io/blog/zh-cn/tags/goroutine/index.xml" rel="self" type="application/rss+xml"/><item><title>Golang ç”Ÿäº§æ¶ˆè´¹æ§åˆ¶æ¨¡å‹</title><link>https://slhmy.github.io/blog/zh-cn/p/go-pc-control-model/</link><pubDate>Sat, 03 Sep 2022 11:09:00 +0800</pubDate><guid>https://slhmy.github.io/blog/zh-cn/p/go-pc-control-model/</guid><description>&lt;img src="https://slhmy.github.io/blog/zh-cn/p/go-pc-control-model/cover.png" alt="Featured image of post Golang ç”Ÿäº§æ¶ˆè´¹æ§åˆ¶æ¨¡å‹" />&lt;p>&lt;strong>å‰æƒ…æè¦æ˜¯è¿™æ ·çš„ï¼š&lt;/strong>&lt;/p>
&lt;p>æˆ‘æ˜¨å¤©å‚åŠ äº†æˆ‘éå¸¸å–œæ¬¢çš„æŸå…¬å¸çš„å…¨æ ˆå¼€å‘å·¥ç¨‹å¸ˆçš„é¢è¯•ï¼Œ
åœ¨ä»‹ç»äº†æˆ‘å„ç§è¿‡å¾€å¥‡å¥‡æ€ªæ€ªçš„ï¼ˆçœŸçš„æ˜¯éå¸¸å¥‡æ€ªçš„ï¼Œé¢è¯•å®˜å¬äº†ä»¥åç›´çš±çœ‰ğŸ˜‚ï¼‰é¡¹ç›®ä¹‹åï¼Œ
é¢è¯•å®˜å¼€å§‹è€ƒæ ¸æˆ‘çš„ä¸€äº›å®æˆ˜èƒ½åŠ›ã€‚
ç„¶åä¸Šæ¥çš„ç¬¬ä¸€é“ä»£ç è®¾è®¡çš„é¢˜ç›®å°±æŠŠæˆ‘è€ƒåˆ°äº†ï¼Œ&lt;strong>è¦æˆ‘ç”¨åç¨‹å®ç°å¤šç”Ÿäº§å¤šæ¶ˆè´¹ï¼Œå¹¶ä¸”èƒ½æ§åˆ¶åç¨‹åˆ›å»ºé€€å‡º&lt;/strong>ã€‚&lt;/p>
&lt;p>å¯èƒ½æ˜¯æˆ‘ Golang åªæ¥è§¦äº†ä¸€ä¸ªæœˆå·¦å³çš„æ—¶é—´ï¼Œ
è™½ç„¶ä¹‹å‰ç¡®å®æœ‰ä¸€æ¬¡è¢«è€ƒåˆ° &lt;code>channel&lt;/code> çš„ç”¨æ³•ï¼ˆä½†å¤ç›˜çš„æ—¶å€™ä¹Ÿå°±æ˜¯ç®€å•è¡¥ä¹ äº†ä¸€ä¸‹ &lt;code>make channel&lt;/code>ï¼‰ã€‚
è¿™æ¬¡ä¸Šæ¥ç›´æ¥åŠ¨æ‰‹è¦å†™ä»£ç ï¼Œè¿˜æ˜¯å¾ˆå¤šååº”ä¸è¿‡æ¥ï¼Œæˆ‘ç›´æ¥å°±å¯„äº†&amp;hellip;
æŸ¥äº†ä¸€ä¼š &lt;code>channel&lt;/code> çš„ç”¨æ³•ï¼Œåé¢æ†‹å‡ºå‡ è¡Œåˆå‘ç°ä¸ºäº†ä¸è®©è¿›ç¨‹è¿‡æ—©é€€å‡ºè¿˜è¦ä½¿ç”¨ &lt;code>waitGroup&lt;/code> è¿™äº›ğŸ˜‡ã€‚
ç„¶åä¸Šé¢è¯´åˆ°çš„æ¨¡å‹ç¡®å®æ¯”è¾ƒé‡è¦çš„ï¼Œæ¯•ç«Ÿæˆ‘ç®€å†ä¸Šä¹Ÿå¹å˜˜è‡ªå·±æŒæ¡å„ç§å¼‚æ­¥ä»»åŠ¡è®¾è®¡&amp;hellip;
ç»“æœå°±æ˜¯å•ªå•ªæ‰“è„¸ã€‚&lt;/p>
&lt;p>äºæ˜¯åœ¨è¿™åœºè¢«è™çš„éå¸¸æƒ¨çƒˆçš„é¢è¯•ä¹‹åï¼Œæˆ‘å†³å®šæŠŠè¿™æ ·ä¸€ä¸ªç”Ÿäº§æ¶ˆè´¹æ¨¡å‹å¥½å¥½è¡¥ä¸€ä¸‹ã€‚
æœ€åè¡¥ä¹ å®Œäº†ä»¥åå‘ç°ï¼Œå¤§é‡çš„å†…å®¹è¿˜æ˜¯è·Ÿ Golang çš„ &lt;code>channel&lt;/code> ç”¨æ³•æœ‰å…³ï¼Œé‚£ä¹ˆè¿™ç¯‡æ–‡ç« å°±ä¸»è¦å¯¹å…¶åšä¸€ä¸ªæ¢³ç†ã€‚&lt;/p>
&lt;h2 id="åŸºç¡€">åŸºç¡€
&lt;/h2>&lt;p>æˆ‘ä¸ä¼šè®²å¤ªå¤šï¼Œå› ä¸ºå¾ˆå¤šåœ°æ–¹å¯ä»¥æŸ¥åˆ°ï¼Œä»‹ç»çš„è‚¯å®šä¹Ÿæ›´è¯¦ç»†ã€‚
è¿™é‡Œåªæ˜¯æä¾›ä¸€ä¸ªè¾ƒå¿«çš„äº†è§£ã€‚&lt;/p>
&lt;h3 id="channel">channel
&lt;/h3>&lt;p>é¦–å…ˆå¯¹ channel éœ€è¦æŒæ¡å®ƒçš„ç±»å‹å£°æ˜ã€åˆ›å»ºå’Œæ“ä½œæ–¹æ³•ã€‚&lt;/p>
&lt;h4 id="channelçš„ç±»å‹å£°æ˜">channelçš„ç±»å‹å£°æ˜
&lt;/h4>&lt;p>åœ¨Golangå½“ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ &lt;code>[VARIABLE NAME] &amp;lt;-chan | chan | chan&amp;lt;- [TYPE]&lt;/code> è¿™æ ·çš„å¥å¼æ¥å£°æ˜ä¸€ä¸ª &lt;code>channel&lt;/code> å’Œå®ƒå†…éƒ¨çš„æ•°æ®ç±»å‹ã€‚
è¿™é‡Œ &lt;code>chan&lt;/code> æœ‰ç‚¹åƒä¸€ä¸ªå‰ç¼€çš„ä¿®é¥°è¯ï¼Œå¯èƒ½ç”±äºæ˜¯å…³é”®å­—çš„åŸå› ï¼Œåœ¨ç”¨æ³•ä¸Šå’Œæ™®é€šæ³›å‹ä¸Šæœ‰åŒºåˆ†ã€‚
æˆ‘è®¤ä¸ºå…³é”®æ˜¯è¦ä½¿ç”¨&lt;strong>è±¡å½¢&lt;/strong>çš„è®°å¿†æ–¹å¼ï¼ŒæŠŠ &lt;code>chan&lt;/code> æœ¬èº«å°±æƒ³è±¡æˆä¸€ä¸ªç®¡é“ï¼Œä½ å¯ä»¥åœ¨ &lt;code>chan&lt;/code> çš„ä¸¤ä¾§ç”¨ &lt;code>&amp;lt;-&lt;/code> æ¥æ ‡è®° &lt;code>chan&lt;/code> åœ¨è¿™ä¸ªä½œç”¨åŸŸä¸­çš„å¯ä»¥ä½¿ç”¨çš„ç«¯å£æ˜¯å†™ç«¯è¿˜æ˜¯è¯»ç«¯ï¼Œæ²¡æœ‰æ ‡è®°æ—¶ä»£è¡¨å…è®¸åŒç«¯çš„æ“ä½œ&lt;/p>
&lt;h4 id="channelçš„åˆ›å»º">channelçš„åˆ›å»º
&lt;/h4>&lt;p>é€šè¿‡ &lt;code>make&lt;/code> æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ª &lt;code>channel&lt;/code> ï¼Œè¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯ &lt;code>make&lt;/code> åˆ†é…çš„å®¹é‡æ˜¯æ ¹æ®å¯¹è±¡çš„åŸå­ä¸ªæ•°åˆ†é…çš„ã€‚
åƒ &lt;code>string&lt;/code> ç±»å‹ï¼Œåˆ†é…çš„æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œè¿™é‡Œæ˜¯å®¹æ˜“ç†è§£é”™çš„ã€‚
ä½†å¦‚æœä½ æ˜¯åˆ›å»ºçš„ä¸€ä¸ª &lt;code>struct&lt;/code>ï¼Œé‚£åˆ†é…çš„å®¹é‡æ˜¯â€œå¤šå°‘ä¸ªstructâ€ã€‚&lt;/p>
&lt;h4 id="channelçš„æ“ä½œ">channelçš„æ“ä½œ
&lt;/h4>&lt;p>&lt;code>chan&lt;/code> æœ€åŸºæœ¬çš„æ“ä½œå°±æ˜¯å†™å€¼å’Œå–å€¼æ“ä½œã€‚&lt;/p>
&lt;p>å†™å€¼çš„è¯­æ³•æ˜¯ &lt;code>[CHANNEL] &amp;lt;- [VARIABLE] | [VALUE]&lt;/code>ï¼Œæ˜¯è±¡å½¢çš„æ“ä½œæ–¹å¼ã€‚&lt;/p>
&lt;p>å–å€¼çš„è¯­æ³•æ˜¯ &lt;code>[VARIABLE] := &amp;lt;-[CHANNEL]&lt;/code>ï¼Œä»£è¡¨ä»å†™ç«¯å–å€¼ï¼Œ
æ­¤å¤–è¿˜æœ‰å’Œ &lt;code>range&lt;/code> ä¸€èµ·ä½¿ç”¨çš„ä¸€äº›è¯­æ³•ç³–ï¼ˆè¿™é‡Œå°±ä¸è¿‡å¤šä»‹ç»äº†ï¼‰ã€‚&lt;/p>
&lt;h3 id="context">Context
&lt;/h3>&lt;p>&lt;code>Context&lt;/code> çš„ä¸­æ–‡å«ä¹‰æ˜¯ä¸Šä¸‹æ–‡ï¼Œè¿™ç±»è®¾è®¡å…¶å®åœ¨å¾ˆå¤šæœåŠ¡æ¡†æ¶ä¸­æœ‰åšåˆ°ã€‚
åƒåœ¨Rustçš„ä¸€äº›Webæ¡†æ¶ä¸­ï¼Œä¼šæœ‰ &lt;code>app.data&lt;/code> çš„è®¾è®¡ï¼Œè¿™æ ·åšçš„ç›®çš„ä¸»è¦å°±æ˜¯æ–¹ä¾¿çº¿ç¨‹/åç¨‹ä¹‹é—´å®ç°æ•°æ®çš„å…±äº«ã€‚&lt;/p>
&lt;p>åœ¨Golangå½“ä¸­ï¼Œæˆ‘è®¤ä¸º &lt;code>Context&lt;/code> ä¹Ÿèµ·åˆ°äº†ç±»ä¼¼çš„ä½œç”¨ã€‚
ä½†åœ¨è¿™æ ·ä¸€ä¸ªåŠŸèƒ½çš„åŸºç¡€ä¸Šï¼Œ&lt;code>Context&lt;/code> è¿˜æä¾›äº†ä¸€äº›ç‰¹æ®Šå­—æ®µå’Œæ§åˆ¶æ–¹æ³•ï¼Œç”¨æ¥å®ç°å¯¹åç¨‹çš„æ§åˆ¶ã€‚
æœ€é‡è¦çš„ä¸€ç§ç”¨æ³•å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="k">select&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">case&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">ctx&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Done&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">default&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// normal works when this goroutine is up
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æˆ‘ä»¬é€šè¿‡ &lt;code>ctx.Done&lt;/code> è¿™ä¸ªç®¡é“æ¥åˆ¤æ–­åç¨‹æ˜¯å¦éœ€è¦ç»ˆæ­¢ï¼Œ
è¿™ä¸ªç®¡é“çš„æ¶ˆæ¯å¯ä»¥é€šè¿‡è®¾ç½® &lt;code>TimeOut&lt;/code> æˆ–è€…æ‰‹åŠ¨ &lt;code>cancel&lt;/code> ç­‰æ–¹æ³•æ¥å‘é€ã€‚
å…·ä½“å¯ä»¥æŸ¥é˜…ç›¸å…³çš„èµ„æ–™ã€‚&lt;/p>
&lt;h2 id="practice">Practice
&lt;/h2>&lt;p>æœ€åæˆ‘ä»¬æ¥æä¸€ä¸‹å¤šç”Ÿäº§å¤šæ¶ˆè´¹è¿™ä¸ªæ¨¡å‹çš„å®è·µã€‚
æ€è·¯å…¶å®å¾ˆç®€å•ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª &lt;code>channel&lt;/code> æ¥ä½œä¸ºæ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¦å¤–æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ª &lt;code>Context&lt;/code> æ¥æ§åˆ¶åç¨‹çš„é€€å‡ºã€‚&lt;/p>
&lt;p>æˆ‘ä»¬é¦–å…ˆå®šä¹‰æ¶ˆæ¯çš„æ ¼å¼ï¼Œå¹¶å‡†å¤‡ &lt;code>channel&lt;/code> å’Œ &lt;code>Context&lt;/code>ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="nx">Message&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Content&lt;/span> &lt;span class="kt">string&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">ctx&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">cancel&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">context&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">WithCancel&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">context&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Background&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">dataChannel&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="nx">Message&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">countChannel&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>dataChannel&lt;/code> æ˜¯ç”¨æ¥ç”Ÿäº§çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œ&lt;code>countChannel&lt;/code> æ˜¯ç”Ÿäº§è€…ä¹‹é—´ç”¨æ¥ååŒæ§åˆ¶æ¶ˆæ¯å·çš„ã€‚
ç”±äº &lt;code>countChannel&lt;/code> çš„è¯»å†™ä¼šå‘ç”Ÿåœ¨ä¸€ä¸ªç”Ÿäº§è€…å½“ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€ä¸ªå¤§å°ä¸º1çš„ç¼“å†²ï¼Œ
æ¯æ¬¡ç”Ÿäº§è€…è¿›è¡Œç”Ÿäº§ä¹‹å‰ï¼Œç”Ÿäº§è€…ä¼šå…ˆè¯»å–ç¼“å†²ä¸­çš„å€¼ï¼Œå¹¶æŠŠæœ€æ–°çš„æ¶ˆæ¯å·æ›´æ–°ã€‚&lt;/p>
&lt;p>æœ€åç»“åˆ &lt;code>Context&lt;/code> çš„åŸºæœ¬ç”¨æ³•ï¼Œæˆ‘ä»¬å¾—åˆ°çš„æ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼š&lt;/p>
&lt;h3 id="producer-æ ¸å¿ƒé€»è¾‘">Producer æ ¸å¿ƒé€»è¾‘
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="k">select&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// Handle &amp;lt;-ctx.Done()
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">case&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">ctx&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Done&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Producer_%d quit\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">id&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">default&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Get message count
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">Count&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">countCh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Count&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">countCh&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">Count&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Produce
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">dataCh&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">Message&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Content&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Producer_%d sending message_%d&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">id&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Count&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Second&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="consumer-æ ¸å¿ƒé€»è¾‘">Consumer æ ¸å¿ƒé€»è¾‘
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// Consume
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">data&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">dataCh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Consumer_%d get message: %s\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">id&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">data&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Content&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item></channel></rss>